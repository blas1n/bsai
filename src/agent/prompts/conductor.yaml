# Conductor Agent Prompts
#
# Mako template variables:
# - original_request: User's original request text

analysis_prompt: |
  Break down the user request into actionable milestones.

  USER REQUEST:
  ${original_request}

  ${worker_capabilities()}

  COMPLEXITY LEVELS:
  - TRIVIAL: Simple facts, basic calculations (<100 tokens)
  - SIMPLE: Straightforward tasks with clear steps (<500 tokens)
  - MODERATE: Tasks requiring analysis or multi-step reasoning (<2000 tokens)
  - COMPLEX: Tasks requiring deep expertise or complex logic (<8000 tokens)
  - CONTEXT_HEAVY: Tasks with massive context or research (>8000 tokens)

  RULES:
  - Use MINIMUM milestones needed (prefer fewer, larger milestones)
  - Each milestone must be independently executable
  - Milestones can include: code generation, documentation, explanations, answers
  - IMPORTANT: Include ALL specific details from the user request in milestone descriptions (URLs, file paths, IDs, names, etc.)
  - The milestone description should be self-contained - the worker will only see the description, not the original request

replan_prompt: |
  You are replanning a task based on new information discovered during execution.

  ## Original Request
  ${original_request}

  ## Completed Milestones
  ${completed_text}

  ## Current Milestone (index ${current_milestone_index})
  ${current_text}

  ## Remaining Milestones
  ${remaining_text}

  ## Observations from Execution
  ${observations_text}

  ## QA Feedback
  ${qa_feedback}

  ## Replan Reason
  ${replan_reason}

  ## Previous Replans
  ${replans_text}

  ## Instructions
  Based on this information, determine what modifications are needed to the remaining plan.
  You can ADD, MODIFY, REMOVE, or REORDER milestones.

  Guidelines:
  1. Only modify remaining milestones (index >= ${current_milestone_index})
  2. Keep modifications minimal - only change what's necessary
  3. Ensure the revised plan still achieves the original goal
  4. Consider dependencies between milestones
  5. Maximum 3 new milestones can be added per replan
  6. Provide clear reasoning for each modification

  Respond with a structured JSON containing:
  - analysis: Your analysis of the situation
  - modifications: List of modifications (action, target_index, new_milestone, reason)
  - confidence: Your confidence in the revised plan (0.0-1.0)
  - reasoning: Overall reasoning for the changes

rethink_strategy_prompt: |
  The previous approach to this task has failed after multiple attempts.
  You need to devise a COMPLETELY DIFFERENT strategy.

  ## Original Request
  ${original_request}

  ## Previous Approach That Failed
  ${failed_approach}

  ## Why It Failed
  ${failure_reasons}

  ${worker_capabilities()}

  ## Instructions
  Create a NEW plan using a fundamentally different approach:
  1. DO NOT repeat the same strategy that failed
  2. Consider alternative methods, tools, or decomposition
  3. If the task seems impossible, create a single milestone explaining why and what alternatives exist
  4. Keep the new plan minimal but achievable

  COMPLEXITY LEVELS:
  - TRIVIAL: Simple facts, basic calculations (<100 tokens)
  - SIMPLE: Straightforward tasks with clear steps (<500 tokens)
  - MODERATE: Tasks requiring analysis or multi-step reasoning (<2000 tokens)
  - COMPLEX: Tasks requiring deep expertise or complex logic (<8000 tokens)
  - CONTEXT_HEAVY: Tasks with massive context or research (>8000 tokens)
